# Malware

## Droppers

### Payload executable storage 

Where to store the shellcode inside `Dropper.exe`?
- `.text`
  - functions
- `.data`
  - global vars
  - constants
- `.rsc`
  - Other files within a file, included in compile time

## Malware Development tools - Windows

- cvtres converter - resource file to obj-file
- rundll32 - Run DLL from shell


## Malware analysis and RevEng

- https://www.youtube.com/watch?v=yf6J8XO_wpY - An Introduction To Malware Analysis video

### Tools

#### Classics RevEng Tools 

- strace
- ltrace
- strings
- gdb

#### Malware specific

- `fiddler` - HTTP debugger
- `pdfdetach` - export files from pdf
- `olevba` - info about visual basic macros
- `regshot` - Windows registry snapshot - https://github.com/Seabreg/Regshot
- `CheatEngine` - Memory manipulation

#### Generic

- `PEBear`/`DumpBin` - Dissect binary into sections (CLI)
- `procmon`/`process explorer`/`ProcessHacker` - Proc info (modules, memory, usage ...)
- `wireshark` - Network 
- `Cuckoo` - open source automated malware analysis system
- `pestudio` - Malware Initial Assessment -https://www.winitor.com/


## RevEng Tools - Windows

- PEBear - Dissect binary into sections
- ProcessHacker - Proc info (modules, memory, usage ...)
- CheatEngine - Memory manipulation
- DumpBin - Dissect binary into sections (CLI)
- ResourcesExtract - https://www.nirsoft.net/utils/resources_extract.html
- AssetStudioGUI - resource browser for Unity games

## Reverse engineering

`dbg` + `ghidra` - user input does not work.

There is a workaround: https://github.com/NationalSecurityAgency/ghidra/issues/3174
